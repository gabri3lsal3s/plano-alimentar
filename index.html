<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="IkigaiHub - Seu hub completo para saúde e bem-estar">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <title>IkigaiHub - Seu Hub de Saúde</title>
</head>
<body>
    <header>
        <h1>IkigaiHub</h1>
        <h2><i>Seu Hub de Saúde e Bem-estar</i></h2>
        <nav>
            <a href="index.html" class="active">Home</a>
            <a href="plano_alimentar.html">Plano Alimentar</a>
            <a href="exercicios.html">Exercícios</a>
        </nav>
    </header>

    <div class="home-columns">
        <section id="plano-alimentar">
            <div>
                <div id="refeicao-atual" class="refeicao-atual">
                    <h4>Refeição Atual</h4>
                    <div id="refeicao-content">
                        <p>Carregando...</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="exercicios">
            <div>
                <div id="exercicio-atual" class="exercicio-atual">
                    <h4>Treino de Hoje</h4>
                    <div id="exercicio-content">
                        <p>Carregando...</p>
                    </div>
                </div>
            </div>
        </section>
                    </div>
                    
    <div class="extras-columns">
        <div class="extras-single-column">
            <section id="tarefas-dia">
                <div class="tarefas-bloco">
                    <h4>Tarefas do Dia</h4>
                    <form id="form-tarefa">
                        <input type="text" id="input-tarefa" placeholder="Adicionar nova tarefa..." maxlength="80" autocomplete="off">
                        <button type="submit">Adicionar</button>
                    </form>
                    <ul id="lista-tarefas"></ul>
                    <h5 class="tarefas-feitas-titulo">Tarefas Feitas</h5>
                    <ul id="lista-tarefas-feitas"></ul>
                    <button id="copiar-tarefas" class="btn-copiar">Copiar</button>
                </div>
            </section>
            <section id="notas-dia">
                <div class="notas-bloco">
                    <h4>Notas do Dia</h4>
                    <div class="nota-input-row">
                        <textarea id="nota-dia" rows="4" placeholder="Escreva suas notas do dia..."></textarea>
                        <button id="salvar-nota">Salvar Nota</button>
                    </div>
                    <h5 class="notas-historico-titulo">Histórico de Notas</h5>
                    <ul id="notas-historico"></ul>
                    <button id="copiar-notas" class="btn-copiar">Copiar</button>
                </div>
            </section>
                        </div>
                    </div>
    <footer><p></p></footer>

    <script src="script.js"></script>
    <script>
        // Função para determinar a refeição atual baseada no horário
        function getRefeicaoAtual() {
            const agora = new Date();
            const hora = agora.getHours();
            if (hora >= 7 && hora < 9) return 'cafe';
            if (hora >= 9 && hora < 11) return 'lancheM';
            if (hora >= 12 && hora < 14) return 'almoco';
            if (hora >= 15 && hora < 17) return 'lancheT';
            if (hora >= 19 && hora < 21) return 'janta';
            if (hora >= 21 || hora < 7) return 'ceia';
            if (hora >= 11 && hora < 12) return 'almoco';
            if (hora >= 14 && hora < 15) return 'lancheT';
            if (hora >= 17 && hora < 19) return 'janta';
            return 'ceia';
        }
        // Função para determinar o exercício atual baseado no dia da semana
        function getExercicioAtual() {
            const agora = new Date();
            const diaSemana = agora.getDay();
            switch(diaSemana) {
                case 1: return 'segunda';
                case 2: return 'terca';
                case 3: return 'quarta';
                case 4: return 'quinta';
                case 5:
                case 6:
                case 0:
                default: return 'adicional';
            }
        }
        // Dados de fallback caso o fetch falhe
        const dadosFallback = {
            refeicoes: {
                cafe: { nome: "Café da Manhã", horario: "07h às 09h", receitas: [{ titulo: "Omelete Proteica Completa", ingredientes: ["3 ovos inteiros", "30g de queijo cottage", "1 fatia de pão integral", "1 colher de sopa de azeite", "Espinafre, tomate e temperos"], preparo: "Bata os ovos, adicione o cottage e refogue com azeite. Sirva com pão integral e vegetais", calorias: "~520 kcal, 28g proteína, 35g carboidratos, 28g gorduras" }] },
                lancheM: { nome: "Lanche da Manhã", horario: "09h às 11h", receitas: [{ titulo: "Iogurte Grego com Frutas", ingredientes: ["150g de iogurte grego natural", "1 banana pequena", "15g de granola", "10g de mel"], preparo: "Misture o iogurte com a banana cortada, adicione granola e mel", calorias: "~380 kcal, 18g proteína, 52g carboidratos, 12g gorduras" }] },
                almoco: { nome: "Almoço", horario: "12h às 14h", receitas: [{ titulo: "Prato Principal Completo", ingredientes: ["150g de peito de frango grelhado", "100g de arroz integral cozido", "80g de feijão preto", "150g de macaxeira cozida", "Salada de folhas verdes com azeite", "Legumes refogados"], preparo: "Grelhe o frango, prepare o arroz e feijão, cozinhe a macaxeira e monte o prato com todos os componentes", calorias: "~750 kcal, 35g proteína, 85g carboidratos, 20g gorduras" }] },
                lancheT: { nome: "Lanche da Tarde", horario: "15h às 17h", receitas: [{ titulo: "Smoothie Proteico Pós-Treino", ingredientes: ["25g de whey protein", "200ml de leite integral", "1 banana", "30g de aveia", "Canela a gosto"], preparo: "Bata todos os ingredientes no liquidificador até ficar homogêneo", calorias: "~390 kcal, 28g proteína, 45g carboidratos, 8g gorduras" }] },
                janta: { nome: "Janta", horario: "19h às 21h", receitas: [{ titulo: "Sopa Proteica de Frango", ingredientes: ["150g de peito de frango", "100g de abóbora", "50g de cenoura", "30g de quinoa", "Temperos verdes"], preparo: "Cozinhe o frango com legumes, adicione quinoa e temperos", calorias: "~420 kcal, 35g proteína, 35g carboidratos, 15g gorduras" }] },
                ceia: { nome: "Ceia", horario: "21h às 23h", receitas: [{ titulo: "Queijo Cottage com Frutas", ingredientes: ["100g de queijo cottage", "1/2 banana", "10g de castanha-do-Pará", "Canela a gosto"], preparo: "Misture o cottage com a banana, adicione castanhas e canela", calorias: "~220 kcal, 18g proteína, 15g carboidratos, 12g gorduras" }] }
            },
            exercicios: {
                segunda: { nome: "Segunda-feira", titulo: "Sessão A (Peito, Tríceps, Ombros) + Kung Fu", exercicios: ["Supino Reto com Barra – 4×8-12", "Supino Inclinado com Halteres – 3×8-10", "Desenvolvimento Militar Sentado – 3×8-12", "Tríceps Testa com Barra W – 3×10-12", "Elevação Lateral – 3×12-15", "Mergulho – 2×máx.", "Kung Fu: Treino técnico leve (45 min)"] },
                terca: { nome: "Terça-feira", titulo: "Sessão B (Costas, Bíceps, Abdômen)", exercicios: ["Puxada na Barra Fixa/Pulldown – 4×6-10", "Remada Curvada – 3×8-12", "Remada Unilateral – 3×10-12", "Rosca Direta – 3×8-12", "Rosca Martelo – 2×10-12", "Prancha – 3×45 s", "Abdominais – 3×10"] },
                quarta: { nome: "Quarta-feira", titulo: "Sessão C (Pernas, Glúteos)", exercicios: ["Agachamento Livre – 4×8-10", "Leg Press 45° – 3×10-12", "Stiff com Barra – 3×8-12", "Avanço com Halteres – 3×10/leg", "Cadeira Extensora – 2×12-15", "Panturrilha em Pé – 4×12-20"] },
                quinta: { nome: "Quinta-feira", titulo: "Sessão D (Costas Leves, Bíceps, Core) + Kung Fu", exercicios: ["Pulldown Neutra – 3×8-12", "Remada Baixa – 3×10-12", "Rosca Scott – 3×8-12", "Hiperextensão Lombar – 3×12-15", "Abdominais Bicicleta – 3×20", "Prancha Lateral – 2×30 s/cada", "Kung Fu: Combate leve (45 min)"] },
                adicional: { nome: "Fim de Semana", titulo: "Exercícios Adicionais", exercicios: ["Cardio: Corrida ou Bicicleta – 20-30 min", "Alongamento Dinâmico – 10 min", "Mobilidade de Ombro – 5 min", "Respiração Diafragmática – 5 min", "Meditação – 10 min"] }
            }
        };
        // Função para buscar dados da página de plano alimentar
        async function buscarDadosRefeicoes() {
            try {
                const response = await fetch('plano_alimentar.html');
                if (!response.ok) throw new Error();
                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const refeicoes = {};
                const secoes = ['cafe', 'lancheM', 'almoco', 'lancheT', 'janta', 'ceia'];
                secoes.forEach(secao => {
                    const elemento = doc.getElementById(secao);
                    if (elemento) {
                        const h3 = elemento.querySelector('h3');
                        const ul = elemento.querySelector('ul');
                        if (h3 && ul) {
                            const partes = h3.textContent.split('—');
                            const nome = partes[0]?.trim() || '';
                            const horario = partes[1]?.trim() || '';
                            const receitas = [];
                            ul.querySelectorAll('li').forEach(item => {
                                const h4 = item.querySelector('h4');
                                if (h4) {
                                    const titulo = h4.textContent;
                                    let ingredientes = [];
                                    let preparo = '';
                                    let calorias = '';
                                    item.querySelectorAll('p').forEach(p => {
                                        const text = p.textContent;
                                        if (text.includes('Ingredientes:')) {
                                            const ol = p.nextElementSibling;
                                            if (ol && ol.tagName === 'OL') {
                                                ingredientes = Array.from(ol.querySelectorAll('li')).map(li => li.textContent);
                                            }
                                        } else if (text.includes('Preparo:')) {
                                            preparo = text.replace('Preparo:', '').trim();
                                        } else if (text.includes('Valores nutricionais:')) {
                                            calorias = text.replace('Valores nutricionais:', '').trim();
                                        }
                                    });
                                    if (titulo && ingredientes.length > 0) {
                                        receitas.push({ titulo, ingredientes, preparo, calorias });
                                    }
                                }
                            });
                            if (receitas.length > 0) {
                                refeicoes[secao] = { nome, horario, receitas };
                            }
                        }
                    }
                });
                return Object.keys(refeicoes).length > 0 ? refeicoes : dadosFallback.refeicoes;
            } catch (error) {
                return dadosFallback.refeicoes;
            }
        }
        // Função para buscar dados da página de exercícios
        async function buscarDadosExercicios() {
            try {
                const response = await fetch('exercicios.html');
                if (!response.ok) throw new Error();
                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const exercicios = {};
                const secoes = ['segunda', 'terca', 'quarta', 'quinta', 'adicional'];
                secoes.forEach(secao => {
                    const elemento = doc.getElementById(secao);
                    if (elemento) {
                        const h3 = elemento.querySelector('h3');
                        const ul = elemento.querySelector('ul');
                        if (h3 && ul) {
                            const partes = h3.textContent.split('—');
                            const nome = partes[0]?.trim() || '';
                            const titulo = partes[1]?.trim() || h3.textContent;
                            const exerciciosList = Array.from(ul.querySelectorAll('li')).map(li => li.textContent);
                            if (exerciciosList.length > 0) {
                                exercicios[secao] = { nome, titulo, exercicios: exerciciosList };
                            }
                        }
                    }
                });
                return Object.keys(exercicios).length > 0 ? exercicios : dadosFallback.exercicios;
            } catch (error) {
                return dadosFallback.exercicios;
            }
        }
        // Função para exibir a refeição atual
        async function exibirRefeicaoAtual() {
            const refeicoes = await buscarDadosRefeicoes();
            if (!refeicoes) {
                document.getElementById('refeicao-content').innerHTML = '<p>Erro ao carregar dados das refeições</p>';
                return;
            }
            const refeicaoKey = getRefeicaoAtual();
            const refeicao = refeicoes[refeicaoKey];
            if (!refeicao || !refeicao.receitas || refeicao.receitas.length === 0) {
                document.getElementById('refeicao-content').innerHTML = '<p>Nenhuma refeição encontrada para este horário</p>';
                return;
            }
            const receita = refeicao.receitas[0];
            const content = document.getElementById('refeicao-content');
            content.innerHTML = `
                <div class="refeicao-info">
                    <h5>${refeicao.nome} — ${refeicao.horario}</h5>
                    <h6>${receita.titulo}</h6>
                    <p><strong>Ingredientes:</strong></p>
                    <ul>
                        ${receita.ingredientes.map(ing => `<li>${ing}</li>`).join('')}
                    </ul>
                    <p><strong>Preparo:</strong> ${receita.preparo}</p>
                    <p><strong>Valores nutricionais:</strong> ${receita.calorias}</p>
                </div>
            `;
        }
        // Função para exibir o exercício atual
        async function exibirExercicioAtual() {
            const exercicios = await buscarDadosExercicios();
            if (!exercicios) {
                document.getElementById('exercicio-content').innerHTML = '<p>Erro ao carregar dados dos exercícios</p>';
                return;
            }
            const exercicioKey = getExercicioAtual();
            const exercicio = exercicios[exercicioKey];
            if (!exercicio) {
                document.getElementById('exercicio-content').innerHTML = '<p>Nenhum exercício encontrado para hoje</p>';
                return;
            }
            const content = document.getElementById('exercicio-content');
            content.innerHTML = `
                <div class="exercicio-info">
                    <h5>${exercicio.nome}</h5>
                    <h6>${exercicio.titulo}</h6>
                    <ul>
                        ${exercicio.exercicios.map(ex => `<li>${ex}</li>`).join('')}
                    </ul>
                </div>
            `;
        }
        // Inicializar página
        document.addEventListener('DOMContentLoaded', function() {
            exibirRefeicaoAtual();
            exibirExercicioAtual();
        });

        // --- Tarefas do Dia ---
        function renderTarefas() {
            const tarefas = JSON.parse(localStorage.getItem('tarefasDia') || '[]');
            const feitas = JSON.parse(localStorage.getItem('tarefasFeitas') || '[]');
            const ul = document.getElementById('lista-tarefas');
            ul.innerHTML = '';
            tarefas.forEach((tarefa, idx) => {
                const li = document.createElement('li');
                li.textContent = tarefa;
                li.style.cursor = 'pointer';
                li.title = 'Clique para marcar como feita';
                li.onclick = () => {
                    tarefas.splice(idx, 1);
                    feitas.unshift(tarefa);
                    localStorage.setItem('tarefasDia', JSON.stringify(tarefas));
                    localStorage.setItem('tarefasFeitas', JSON.stringify(feitas));
                    renderTarefas();
                };
                ul.appendChild(li);
            });
            // Renderizar tarefas feitas
            const ulFeitas = document.getElementById('lista-tarefas-feitas');
            ulFeitas.innerHTML = '';
            feitas.forEach((tarefa, idx) => {
                const li = document.createElement('li');
                li.textContent = tarefa;
                li.style.textDecoration = 'line-through';
                li.style.opacity = '0.7';
                li.style.cursor = 'pointer';
                li.title = 'Clique para remover da lista de feitas';
                li.onclick = () => {
                    feitas.splice(idx, 1);
                    localStorage.setItem('tarefasFeitas', JSON.stringify(feitas));
                    renderTarefas();
                };
                ulFeitas.appendChild(li);
            });
            // Mostrar ou esconder o título h5
            const h5Feitas = document.querySelector('.tarefas-feitas-titulo');
            h5Feitas.style.display = feitas.length > 0 ? 'block' : 'none';
        }
        document.getElementById('form-tarefa').addEventListener('submit', function(e) {
            e.preventDefault();
            const input = document.getElementById('input-tarefa');
            const val = input.value.trim();
            if (val) {
                const tarefas = JSON.parse(localStorage.getItem('tarefasDia') || '[]');
                tarefas.push(val);
                localStorage.setItem('tarefasDia', JSON.stringify(tarefas));
                input.value = '';
                renderTarefas();
            }
        });
        renderTarefas();
        // --- Notas do Dia ---
        function renderNota() {
            const nota = localStorage.getItem('notaDia') || '';
            document.getElementById('nota-dia').value = nota;
            // Renderizar histórico de notas
            const historico = JSON.parse(localStorage.getItem('notasHistorico') || '[]');
            const ulHistorico = document.getElementById('notas-historico');
            ulHistorico.innerHTML = '';
            historico.forEach((n, idx) => {
                const li = document.createElement('li');
                li.textContent = n.texto + (n.data ? ` (${n.data})` : '');
                li.title = 'Clique para remover do histórico';
                li.style.cursor = 'pointer';
                li.onclick = () => {
                    historico.splice(idx, 1);
                    localStorage.setItem('notasHistorico', JSON.stringify(historico));
                    renderNota();
                };
                ulHistorico.appendChild(li);
            });
            // Mostrar ou esconder o título h5
            const h5Historico = document.querySelector('.notas-historico-titulo');
            h5Historico.style.display = historico.length > 0 ? 'block' : 'none';
        }
        document.getElementById('salvar-nota').addEventListener('click', function() {
            const nota = document.getElementById('nota-dia').value.trim();
            localStorage.setItem('notaDia', nota);
            if (nota) {
                let historico = JSON.parse(localStorage.getItem('notasHistorico') || '[]');
                historico.unshift({ texto: nota, data: new Date().toLocaleDateString('pt-BR') });
                historico = historico.slice(0, 10); // Limita a 10 notas
                localStorage.setItem('notasHistorico', JSON.stringify(historico));
            }
            renderNota();
        });
        renderNota();

        // --- Funções de Cópia ---
        function showCopiedMessage(button) {
            const originalText = button.textContent;
            button.textContent = 'Copiado!';
            button.style.backgroundColor = '#388e3c';
            setTimeout(() => {
                button.textContent = originalText;
                button.style.backgroundColor = 'rgba(76, 175, 80, 0.2)';
            }, 1500);
        }

        document.getElementById('copiar-tarefas').addEventListener('click', function() {
            const tarefas = JSON.parse(localStorage.getItem('tarefasDia') || '[]');
            if (tarefas.length === 0) return;
            const textoTarefas = tarefas.map(t => `• ${t}`).join('\n');
            navigator.clipboard.writeText(textoTarefas).then(() => {
                showCopiedMessage(this);
            }).catch(err => console.error('Erro ao copiar tarefas:', err));
        });

        document.getElementById('copiar-notas').addEventListener('click', function() {
            const historico = JSON.parse(localStorage.getItem('notasHistorico') || '[]');
            if (historico.length === 0) return;
            const textoNotas = historico.map(n => `• ${n.data}: ${n.texto}`).join('\n');
            navigator.clipboard.writeText(textoNotas).then(() => {
                showCopiedMessage(this);
            }).catch(err => console.error('Erro ao copiar notas:', err));
        });
    </script>
</body>
</html> 